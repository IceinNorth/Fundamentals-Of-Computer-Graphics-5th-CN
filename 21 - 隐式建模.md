# 21 - 隐式建模
计算机图形学中的隐式建模（也称为隐式曲面）涵盖了许多定义模型的不同方法。这些包括骨架隐式建模、偏移曲面、水平集、变分曲面和代数曲面。
在本章中，我们将简要介绍这些方法，并更详细地描述如何构建骨架隐式模型。
曲线可以用如下形式的隐式方程来定义：
$$f(x,y)=0$$
如果我们考虑一个半径为r的封闭曲线，例如圆，那么隐式方程可以写成：
$$f(x,y)=x^2+y^2-r^2=0$$
f (x, y)的值可以为正(在圆外)，也可以为负(在圆内)，或者恰好在圆上（正好为0）。在三维空间中，等值集是一个由一组围绕着的点暗示的封闭曲面，这个曲面占据了给定的空间体积或区域。体积形成一个标量场，也就是说，我们可以为每个点计算一个值，例如对于圆而言，负值意味着点被限制在圆的内部。
曲面可以被可视化为场中的轮廓，连接具有特定值（如零）的点。计算这样一个曲面意味着）空间中寻找满足隐式方程的点；这种方法不太可能产生一个有效的绘制算法（更不太可能在三维)。这也许是参数化曲线曲面算法先于隐式曲面算法被开发的原因。
然而，也有一些很好的理由来为隐式曲面开发可视化算法。

尽管寻找隐式曲面的计算开销很大，但与其他建模方法相比，使用隐式建模技术进行设计具有一些优势。使用隐式方法简化了许多几何运算，包括：
1. 混合的定义
2. 构造立体几何CSG的标准集操作（并、交、差等）
3. 与其他隐式函数的功能组合）例如，R-函数、Barthe混合、Ricci混合和翘曲）
4. 内部/外部测试（例如，用于碰撞检测）

可视化表面可以通过使用直接光线追踪算法来完成**或**首先转换为多边形。
![](pic/Pasted%20image%2020240424160702.png)
最早的方法之一是Ricci早在1973年就提出的，他也在同一篇论文中介绍了CSG。Jim Blinn在电子密度场中寻找轮廓（算法被称为Blobby molecules）、Nishimura的Metaballs以及Wyvills的Soft Objects都是隐式建模方法的早期例子。Jim Blinn的Blobby Man（见图21.1）是第一个非代数隐式模型的渲染。
## 21.1 隐式函数、骨架基元以及求和混合
在建模的语境下，隐式函数被定义为函数f作用于点p∈E3，产生标量值∈R。

隐式函数fi(x, y, z)可以分为距离函数di(x, y, z)和衰减滤波函数gi(r)，其中r表示到骨架的距离，下标表示第i个骨架元素。

我们将使用以下符号：
$$f_i(x,y,z)=g_i\,\circ\,d_i(x,y,z)$$
一个简单的例子是一个点原语，我们用恒星向太空辐射热量来类比。场值（本例中的温度）可以在任何点p处测量，通过取p到恒星中心的距离并将该值提供给类似于图21.2所示的一个衰减滤波函数来求出场值。
在这些样例函数中，恒星中心的场被赋值为1；该值随着距离的增加而下降。
模型的表面可以由隐式函数f (x, y, z)导出为一系列空间点，这些点的值等于某个期望的等值（iso）。
![](pic/Pasted%20image%2020240424163513.png)
通常，选择滤波函数(gi)是为了使场值在骨架上最大化，并在距离骨架的某个选定距离处降为零。在结果曲面混合在一起的简单情况下，对象的全局场f (x, y, z)隐式函数，可以定义为
$$f(x,y,z)=\sum_{i=1}^{i=n}\,f_i(x,y,z)$$
![](pic/Pasted%20image%2020240424164050.png)
其中n个骨架元素对产生的结果场值有贡献。如图21.3所示，其中任意点(x, y, z)处的场值计算如式(21.3)所示。

在这种情况下，两个点原语被放置得很近。当两个点在一起时，表面凸起，然后混合在一起。之所以使用术语滤波函数，是因为该函数会将原语模糊在一起，这有点类似于图像的过滤器函数。求和混合是适用于隐式曲面的最紧凑、最有效的混合操作（式(21.3)）。

使用具有有限距离的滤波函数的一个优点是，远离p的原语对曲面没有贡献，因此不需要考虑。
### 21.1.1 C1 连续性与梯度
连续性的最基本形式是C0连续性，它确保了函数中没有“跳跃”。高阶连续性是用函数的导数来定义的。
在三维标量场f的情况下，一阶导数是一个称为梯度的矢量函数，写为∇f，定义为：
![](pic/Pasted%20image%2020240424170508.png)
如果∇f在所有点都有定义，且三个一阶偏导数均满足C0连续性，则f满足C1连续性。通俗地说，C1表面连续性意味着表面法线在表面上平滑地变化。举个例子，如果无法在立方体的边缘上定义唯一的面法线，那么这个立方体就不满足C1连续性。
对于隐式曲面上的点，可以通过归一化梯度向量∇f来计算曲面法线。对于许多类型的隐式曲面，内部和外部在感觉上应该是颠倒的，并且由于法向量必须始终指向外，因此它可以与梯度方向相反。

骨架隐式原语是通过对无符号距离字段应用衰减过滤函数创建的，如式(21.2)所示。尽管距离场在骨架处从来不是C1，但这些不连续可以通过使用合适的衰减函数来消除(Akleman & Chen, 1999)。如果一个算子g结合了隐函数f1和f2，其中所有的点都是C1，那么g(f1, f2)不一定是C1。例如，可以使用最小和最大算子来制作一个尖锐的CSG结。这个组合不是C1连续的，因为最小和最大运算符没有这个性质。

运算符的分析是复杂的，因为有时需要创建一个C1不连续。这种情况发生在任何需要在表面产生折痕的时候。例如，一个立方体不是C1，因为每条边都有切线不连续。要使用C1原语创建折痕，操作符必须引入C1不连续点，因此不能是C1本身。
### 21.1.2 距离场、R-函数以及函数表示（F-Reps）
### 21.1.3 水平集
### 21.1.4 变分隐式曲面
### 21.1.5 卷积曲面
### 21.1.6 定义骨架基元
## 21.2 渲染
## 21.3 空间划分
## 21.4 More on 混合
## 21.5 构造立体几何（CSG）
## 21.6 翘曲（Warping）
## 21.7 精细接触建模（PCM）
## 21.8 BlobTree
## 21.9 交互式隐式建模系统